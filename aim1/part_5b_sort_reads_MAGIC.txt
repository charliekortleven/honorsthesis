module load bio/samtools/1.17-gcc-11.4.0

BAM_DIR="/global/scratch/users/charliekortleven/Aim_1_Final/BWA_alignment/MAGIC_seq/MAGIC_aligned_bam/P18/bam"
SORTED_DIR="/global/scratch/users/charliekortleven/Aim_1_Final/BWA_alignment/MAGIC_seq/MAGIC_aligned_bam/P18/bam_sorted"
mkdir -p "$SORTED_DIR"

for bamfile in "$BAM_DIR"/*.bam; do
    base_name=$(basename "$bamfile" .bam)
    sorted_bam="$SORTED_DIR/${base_name}_sorted.bam"
    samtools sort -o "$sorted_bam" "$bamfile"
    echo "sorted $bamfile -> $sorted_bam"
done
