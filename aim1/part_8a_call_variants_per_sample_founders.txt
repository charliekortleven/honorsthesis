module load java/22.0.1
module load python/3.11.6-gcc-11.4.0
module load bio/gatk/4.4.0.0-gcc-11.4.0

REFERENCE="/global/scratch/users/charliekortleven/Aim_1_Final/Mlaciniatus_assembly/daEryLaci1.CHR.p_ctg.fasta"
BAM_FILE="/global/scratch/users/charliekortleven/Aim_1_Final/BWA_alignment/Founder_seq/founder_aligned_sorted_bam_RG_dupsmarked/RK46_withReadGroups_dedup.bam"
OUTPUT_DIR="/global/scratch/users/charliekortleven/Aim_1_Final/GATK_variantdisc/Founder_GVCFs"
OUTPUT_FILE="${OUTPUT_DIR}/RK46_marked_duplicates_RG.g.vcf.gz"

/global/software/rocky-8.x86_64/gcc/linux-rocky8-x86_64/gcc-11.4.0/gatk-4.4.0.0-iu7d6sgb3ukrocvhnsw2yigoss6yjysl/bin/gatk HaplotypeCaller \
    -R "$REFERENCE" \
    -I "$BAM_FILE" \
    -O "$OUTPUT_FILE" \
    --ERC GVCF \
    --min-base-quality-score 20 \
    --max-alternate-alleles 1 \
    --heterozygosity 0.00555 \
    --ploidy 2 \
    --verbosity DEBUG                            
 
echo "generated gvcf at: $OUTPUT_FILE"
